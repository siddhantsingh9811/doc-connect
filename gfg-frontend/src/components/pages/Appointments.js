import '../../styles/appointments.css'
import PageTitle from '../common/PageTitle';
import Calendar from 'react-calendar'
import '../../styles/calendar.css'
import { useEffect, useState } from 'react';
import Planner from '../common/Planner';
import moment from 'moment';
import AppointmentDetails from '../common/AppointmentDetails';
import PlannerRight from '../common/PlannerRight';

const Appointments = () => {
    const [detailed,setDetailed] = useState(false);
    const [ap,setAp] = useState();
    const [rerender,setRerender] = useState("");
    let cur = moment();
    const handleClick = () => {
        setDetailed(!detailed);
    }
    const [date,setDate] = useState(cur);
    useEffect(()=>{
        console.log(ap);
    },[ap]);
    useEffect(()=>{
        try{

            let jank = document.getElementsByClassName('react-calendar__tile--active');
            jank = jank[0];
            jank.onclick = ()=>{
                // console.log("WORKED");
                setDetailed(!detailed);
            };

        }
        catch(err){
            console.log(err);
        }
        
        
    },[date]);
    const handleChange = (value,event)=>{
        let a = moment(value);
        // console.log(a.format("YYYY-MM-DD"));
        setDate(a);
    }
    const C = ()=>{
        return(
            <div className="cont">
                <Planner rerender={rerender} setRerender={setRerender} date={date} setDate={setDate} setAp={setAp}/>
                <PlannerRight rerender={rerender} setRerender={setRerender} setAp={setAp} date={date} setDate={setDate}/>
            </div>
        );
    }
    return ( 
    <div className="appointments">
        <div className="content">
            <PageTitle title="Appointments"/>
            <div className="indicators">
                <div className={detailed?"indicator active":"indicator"} onClick={handleClick}>
                    <div className="text">
                        Day
                    </div>
                    <div className="image">
                        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 0C6.28196 0 0 6.28196 0 14C0 21.718 6.28196 28 14 28C21.718 28 28 21.718 28 14C28 9.17033 25.5476 4.90018 21.8158 2.38346L23.1533 0.667643L17.5 0.462565L19.1315 5.83333L20.3711 4.24056C23.2487 6.12171 25.2459 9.22741 25.6029 12.8356C25.305 12.8519 25.0248 12.9817 24.8196 13.1983C24.6145 13.4148 24.5001 13.7017 24.5 14C24.5002 14.2994 24.6156 14.5873 24.8221 14.804C25.0287 15.0207 25.3107 15.1498 25.6097 15.1644C25.065 20.6878 20.6878 25.065 15.1644 25.6097C15.1498 25.3107 15.0207 25.0287 14.804 24.8221C14.5873 24.6156 14.2994 24.5002 14 24.5C13.7006 24.5002 13.4127 24.6156 13.196 24.8221C12.9793 25.0287 12.8502 25.3107 12.8356 25.6097C7.31215 25.065 2.935 20.6878 2.3903 15.1644C2.68935 15.1498 2.97133 15.0207 3.17789 14.804C3.38445 14.5873 3.49977 14.2994 3.5 14C3.49922 13.7014 3.38395 13.4144 3.17793 13.1982C2.97191 12.982 2.69083 12.8531 2.39258 12.8379C2.94232 7.34631 7.34859 3.12498 12.8538 2.56348C12.9085 2.84973 13.0682 3.10517 13.3017 3.27956C13.5352 3.45395 13.8255 3.53465 14.1155 3.5058C14.4055 3.47694 14.6741 3.34061 14.8687 3.12364C15.0632 2.90666 15.1695 2.62474 15.1667 2.33333V1.16667C15.1666 0.857257 15.0437 0.560529 14.8249 0.341743C14.6061 0.122957 14.3094 3.09363e-05 14 0ZM10.2243 10.2015C8.50695 10.2015 7.35775 11.1947 7.35775 12.667V12.6966H9.0804V12.6624C9.0804 12.0523 9.52009 11.6211 10.1559 11.6211C10.7661 11.6211 11.1676 11.9843 11.1676 12.528C11.1676 12.9632 10.8901 13.3396 9.80273 14.3441L7.46484 16.543V17.8008H13.0908V16.3333H9.97363V16.2376L11.1927 15.112C12.5052 13.943 12.9883 13.216 12.9883 12.3958C12.9883 11.0892 11.8798 10.2015 10.2243 10.2015ZM17.1081 10.3997C15.8317 12.3376 14.9819 13.7374 14.3099 15.0254V16.5999H17.9398V17.7985H19.7194V16.5999H20.6423V15.1325H19.7194V10.3997H17.1081ZM17.8942 11.7441H17.9876V15.1986H15.9346V15.1074C16.7652 13.5581 17.263 12.7171 17.8942 11.7441Z"/>
                        </svg>

                    </div>
                </div>
                <div className={detailed?"indicator":"indicator active"} onClick={handleClick}>
                    <div className="text">
                        Month
                    </div>
                    <div className="image">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21.8182 0H2.18182C0.976364 0 0 0.976364 0 2.18182V21.8182C0 23.0236 0.976364 24 2.18182 24H21.8182C23.0236 24 24 23.0236 24 21.8182V2.18182C24 0.976364 23.0236 0 21.8182 0ZM3.27273 20.7273C2.67055 20.7273 2.18182 20.2385 2.18182 19.6364C2.18182 19.0342 2.67055 18.5455 3.27273 18.5455C3.87491 18.5455 4.36364 19.0342 4.36364 19.6364C4.36364 20.2385 3.87491 20.7273 3.27273 20.7273ZM3.27273 16.3636C2.67055 16.3636 2.18182 15.8749 2.18182 15.2727C2.18182 14.6705 2.67055 14.1818 3.27273 14.1818C3.87491 14.1818 4.36364 14.6705 4.36364 15.2727C4.36364 15.8749 3.87491 16.3636 3.27273 16.3636ZM7.63636 20.7273C7.03418 20.7273 6.54545 20.2385 6.54545 19.6364C6.54545 19.0342 7.03418 18.5455 7.63636 18.5455C8.23855 18.5455 8.72727 19.0342 8.72727 19.6364C8.72727 20.2385 8.23855 20.7273 7.63636 20.7273ZM7.63636 16.3636C7.03418 16.3636 6.54545 15.8749 6.54545 15.2727C6.54545 14.6705 7.03418 14.1818 7.63636 14.1818C8.23855 14.1818 8.72727 14.6705 8.72727 15.2727C8.72727 15.8749 8.23855 16.3636 7.63636 16.3636ZM7.63636 12C7.03418 12 6.54545 11.5113 6.54545 10.9091C6.54545 10.3069 7.03418 9.81818 7.63636 9.81818C8.23855 9.81818 8.72727 10.3069 8.72727 10.9091C8.72727 11.5113 8.23855 12 7.63636 12ZM12 20.7273C11.3978 20.7273 10.9091 20.2385 10.9091 19.6364C10.9091 19.0342 11.3978 18.5455 12 18.5455C12.6022 18.5455 13.0909 19.0342 13.0909 19.6364C13.0909 20.2385 12.6022 20.7273 12 20.7273ZM12 16.3636C11.3978 16.3636 10.9091 15.8749 10.9091 15.2727C10.9091 14.6705 11.3978 14.1818 12 14.1818C12.6022 14.1818 13.0909 14.6705 13.0909 15.2727C13.0909 15.8749 12.6022 16.3636 12 16.3636ZM12 12C11.3978 12 10.9091 11.5113 10.9091 10.9091C10.9091 10.3069 11.3978 9.81818 12 9.81818C12.6022 9.81818 13.0909 10.3069 13.0909 10.9091C13.0909 11.5113 12.6022 12 12 12ZM16.3636 20.7273C15.7615 20.7273 15.2727 20.2385 15.2727 19.6364C15.2727 19.0342 15.7615 18.5455 16.3636 18.5455C16.9658 18.5455 17.4545 19.0342 17.4545 19.6364C17.4545 20.2385 16.9658 20.7273 16.3636 20.7273ZM16.3636 16.3636C15.7615 16.3636 15.2727 15.8749 15.2727 15.2727C15.2727 14.6705 15.7615 14.1818 16.3636 14.1818C16.9658 14.1818 17.4545 14.6705 17.4545 15.2727C17.4545 15.8749 16.9658 16.3636 16.3636 16.3636ZM15.2727 10.9091C15.2727 10.3069 15.7615 9.81818 16.3636 9.81818C16.9658 9.81818 17.4545 10.3069 17.4545 10.9091C17.4545 11.5113 16.9658 12 16.3636 12C15.7615 12 15.2727 11.5113 15.2727 10.9091ZM20.7273 16.3636C20.1251 16.3636 19.6364 15.8749 19.6364 15.2727C19.6364 14.6705 20.1251 14.1818 20.7273 14.1818C21.3295 14.1818 21.8182 14.6705 21.8182 15.2727C21.8182 15.8749 21.3295 16.3636 20.7273 16.3636ZM20.7273 12C20.1251 12 19.6364 11.5113 19.6364 10.9091C19.6364 10.3069 20.1251 9.81818 20.7273 9.81818C21.3295 9.81818 21.8182 10.3069 21.8182 10.9091C21.8182 11.5113 21.3295 12 20.7273 12ZM21.8182 6.54545H2.18182V2.18182H21.8182V6.54545Z" />
                        </svg>


                    </div>
                </div>
            </div>
            {detailed?
            <C />
            :<Calendar onClickDay={handleChange}/>}

            
        </div>
        <div className="sidebar">
            <div className="content">
                <PageTitle title="Details"/>
                {detailed?<AppointmentDetails appointment={ap} />:<Planner date={date} setDate={setDate} setAp={setAp}/>}
            </div>
        </div>
    </div>
    );
}
 
export default Appointments;